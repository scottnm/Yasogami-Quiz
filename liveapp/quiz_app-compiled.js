var Character=function(a,b,c,d){this.name=a;this.description=b;this.percentageThreshold=c;this.image=d},Question=function(a,b,c,d){this.month=a;this.question=b;this.answers=c;this.correctIndex=d;this.element=null},processCharacters=function(a){for(var b in a.characters){var c=a.characters[b];characters.push(new Character(c.name,c.description,c.percentageThreshold,c.image))}},processQuestions=function(a){for(var b in a.months)for(var c in a.months[b]){var d=a.months[b][c];questions.push(new Question(b,
d.question,d.answers,d.correctIndex))}},currentQuestion=null,currentQuestionIndex=0,characters=[],questions=[],prevButton=document.querySelector("button#prev");prevButton.addEventListener("click",prevButtonHandler);var nextButton=document.querySelector("button#next");nextButton.addEventListener("click",nextButtonHandler);var submitButton=document.querySelector("button#submit");submitButton.addEventListener("click",submitButtonHandler);
function constructDom(){for(var a in questions){var b=questions[a],c=document.createElement("div");c.classList.add("question");c.setAttribute("data-state","next");c.setAttribute("id",a);var d=document.createElement("h3");c.appendChild(d);d.innerText="Question "+(Number(a)+1);d=document.createElement("h2");d.innerText=b.question;c.appendChild(d);var d=document.createElement("div"),e;for(e in b.answers){var f=document.createElement("div"),g=document.createElement("input");g.setAttribute("type","radio");
g.setAttribute("name",a);g.setAttribute("id",a+"_"+e);var h=document.createElement("span");h.innerHTML=b.answers[e];f.appendChild(g);f.appendChild(h);f.classList.add("radio");d.appendChild(f)}c.appendChild(d);c.addEventListener("transitionend",function(a){a.target.setAttribute("data-hidden","true")});document.querySelector(".question-lane").appendChild(c);questions[a].element=c}}
function shuffleQuestions(){for(var a=[];questions.length;){var b=Math.floor(Math.random()*questions.length);a.push(questions.splice(b,1)[0])}questions=a}function selectInitialElement(){currentQuestion=questions[0].element;currentQuestion.setAttribute("data-state","active");currentQuestionIndex=0}
function prevButtonHandler(){currentQuestion.setAttribute("data-state","next");--currentQuestionIndex;currentQuestion=questions[currentQuestionIndex].element;currentQuestion.removeAttribute("data-hidden");currentQuestion.setAttribute("data-state","active");currentQuestionIndex||(prevButton.disabled=!0);nextButton.disabled=!1;submitButton.disabled=!0}
function nextButtonHandler(){currentQuestion.setAttribute("data-state","prev");currentQuestionIndex+=1;currentQuestion=questions[currentQuestionIndex].element;currentQuestion.removeAttribute("data-hidden");currentQuestion.setAttribute("data-state","active");currentQuestionIndex===questions.length-1&&(nextButton.disabled=!0,submitButton.disabled=!1);prevButton.disabled=!1}
function submitButtonHandler(){var a=0,b;for(b in questions)correctAnswer(questions[b])&&(a+=1);a=a/questions.length*100;b=determineCharacter(a);constructResultDom(b,a)}function restartButtonHandler(){location.reload()}function correctAnswer(a){var b=a.element.querySelectorAll("input"),c=-1,d;for(d in b)b[d].checked&&(c=d);return c===a.correctIndex}function determineCharacter(a){for(var b in characters)if(0>=a-characters[b].percentageThreshold)return characters[b]}
function constructResultDom(a,b){var c=document.createElement("div");c.classList.add("question");c.classList.add("result");c.setAttribute("data-state","next");var d=document.createElement("div");d.setAttribute("id","img-container");var e=document.createElement("img");e.setAttribute("src",a.image);d.appendChild(e);c.appendChild(d);d=document.createElement("div");d.setAttribute("id","info-container");e=document.createElement("h2");e.innerText="Your score is... "+Math.round(b)+"% correct";d.appendChild(e);
e=document.createElement("p");e.innerText=a.description;d.appendChild(e);c.appendChild(d);document.querySelector(".question-lane").appendChild(c);currentQuestion.setAttribute("data-state","prev");createResetButton();c.setAttribute("data-state","active")}
function createResetButton(){var a=document.createElement("span");a.classList.add("glyphicon");a.classList.add("glyphicon-repeat");var b=document.createElement("button");b.classList.add("btn");b.appendChild(a);b.innerHTML+="Restart";b.addEventListener("click",restartButtonHandler);a=document.createElement("div");a.appendChild(b);b=document.querySelector(".button-bar");b.innerHTML="";b.appendChild(a)}processCharacters(charData);processQuestions(questionData);shuffleQuestions();constructDom();selectInitialElement();
